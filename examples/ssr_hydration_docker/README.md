# solid-ml SSR + Hydration (Docker demo)

This example renders a counter page on the server using `solid-ml-ssr` and then
hydrates it in the browser with `solid-ml-browser`. A Dockerfile is provided to
build and run the demo end-to-end without installing OCaml locally.

## Project layout

```
examples/ssr_hydration_docker/
├── server/
│   ├── dune
│   └── server.ml
├── client/
│   ├── dune
│   └── client.ml
├── static/
│   ├── styles.css
│   └── client.js   (generated by dune build)
├── Dockerfile
└── README.md
```

- `server/server.ml` uses Dream + `solid-ml-ssr` to render HTML.
- `client/client.ml` uses `solid-ml-browser` and Melange for hydration.
- `static/` contains the stylesheet and receives the generated `client.js` bundle.

## Building locally (without Docker)

```bash
# Install dune (if not already available)
export DUNE_VERSION=3.20.2
curl -fsSL https://github.com/ocaml-dune/dune-bin-install/releases/download/v3/install.sh \
  | sh -s -- --install-root $HOME/.local --version $DUNE_VERSION --no-update-shell-config
export PATH="$HOME/.local/bin:$PATH"

# Install dependencies via dune's package manager (no opam installs)
dune pkg lock dream
dune pkg install

# Download a Melange release (matching the version in Dockerfile)
export MELANGE_VERSION=4.0.0
curl -L "https://github.com/melange-re/melange/releases/download/v${MELANGE_VERSION}/melange-${MELANGE_VERSION}-linux-x64.tar.gz" \
  | tar -xz -C /tmp
export PATH="/tmp/melange-${MELANGE_VERSION}-linux-x64/bin:$PATH"

# Build the client bundle (writes to _build/.../client.js)
dune build examples/ssr_hydration_docker/client
cp _build/default/examples/ssr_hydration_docker/client/client_output/examples/ssr_hydration_docker/client/client.js \
   examples/ssr_hydration_docker/static/client.js
```

## Running with Docker

```
cd examples/ssr_hydration_docker
# Build the container image
docker build -t solid-ml-ssr-hydration .

# Run the container (exposes port 8080)
docker run --rm -p 8080:8080 solid-ml-ssr-hydration
```

After the container starts, open <http://localhost:8080> to see the page.
The counter value updates in real time thanks to client-side hydration.
